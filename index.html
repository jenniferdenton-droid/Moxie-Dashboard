<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Moxie Dashboard</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f5f7f8;
      color: #333;
    }

    /* HEADER */
    header {
      background: #fff;
      border-bottom: 2px solid #EBBA95;
      padding: 16px 32px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 14px;
    }

    .moxie-logo {
      height: 40px;
      object-fit: contain;
    }

    header h1 {
      font-size: 1.5rem;
      color: #4E8D99;
      font-weight: 700;
      letter-spacing: 0.5px;
    }

    /* SEARCH */
    .search-bar {
      flex: 1;
      max-width: 400px;
      margin: 0 24px;
    }

    .search-bar input {
      width: 100%;
      padding: 10px 16px;
      border: 1.5px solid #ddd;
      border-radius: 24px;
      font-size: 0.95rem;
      outline: none;
      transition: border 0.2s;
    }

    .search-bar input:focus {
      border-color: #4E8D99;
    }

    /* ADD BUTTON */
    .add-btn {
      background: #4E8D99;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 24px;
      font-size: 0.95rem;
      cursor: pointer;
      font-weight: 600;
      transition: background 0.2s;
      white-space: nowrap;
    }

    .add-btn:hover {
      background: #6D445E;
    }

    /* MAIN CONTENT */
    main {
      padding: 32px;
      max-width: 1400px;
      margin: 0 auto;
    }

    /* CATEGORY SECTION */
    .category {
      margin-bottom: 40px;
    }

    .category-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 16px;
      border-bottom: 2px solid #EBBA95;
      padding-bottom: 8px;
    }

    .category-header h2 {
      font-size: 1.1rem;
      color: #6D445E;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.8px;
    }

    .category-header .emoji {
      font-size: 1.2rem;
    }

    /* APP GRID */
    .app-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 16px;
    }

    /* APP CARD */
    .app-card {
      background: #fff;
      border: 1.5px solid #e8e8e8;
      border-radius: 14px;
      padding: 20px 12px 16px;
      text-align: center;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
      position: relative;
      text-decoration: none;
      color: inherit;
    }

    .app-card:hover {
      border-color: #4E8D99;
      box-shadow: 0 4px 16px rgba(78,141,153,0.15);
      transform: translateY(-2px);
    }

    .app-card img {
      width: 52px;
      height: 52px;
      object-fit: contain;
      border-radius: 10px;
    }

    .app-card .app-name {
      font-size: 0.82rem;
      font-weight: 600;
      color: #444;
      line-height: 1.3;
    }

    /* DELETE BUTTON on card */
    .app-card .delete-btn {
      position: absolute;
      top: 6px;
      right: 8px;
      background: none;
      border: none;
      font-size: 0.75rem;
      color: #ccc;
      cursor: pointer;
      display: none;
      line-height: 1;
    }

    .app-card:hover .delete-btn {
      display: block;
    }

    .app-card .delete-btn:hover {
      color: #e05;
    }

    /* MODAL OVERLAY */
    .modal-overlay {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.35);
      z-index: 200;
      justify-content: center;
      align-items: center;
    }

    .modal-overlay.active {
      display: flex;
    }

    .modal {
      background: #fff;
      border-radius: 16px;
      padding: 32px;
      width: 100%;
      max-width: 460px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.15);
    }

    .modal h2 {
      color: #4E8D99;
      margin-bottom: 20px;
      font-size: 1.2rem;
    }

    .modal label {
      display: block;
      font-size: 0.88rem;
      color: #666;
      margin-bottom: 4px;
      font-weight: 600;
    }

    .modal input,
    .modal select {
      width: 100%;
      padding: 10px 14px;
      border: 1.5px solid #ddd;
      border-radius: 8px;
      font-size: 0.95rem;
      margin-bottom: 16px;
      outline: none;
      transition: border 0.2s;
    }

    .modal input:focus,
    .modal select:focus {
      border-color: #4E8D99;
    }

    .modal-actions {
      display: flex;
      gap: 12px;
      justify-content: flex-end;
      margin-top: 8px;
    }

    .modal-actions button {
      padding: 10px 22px;
      border-radius: 24px;
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
      border: none;
    }

    .btn-cancel {
      background: #f0f0f0;
      color: #666;
    }

    .btn-save {
      background: #4E8D99;
      color: white;
    }

    .btn-save:hover { background: #6D445E; }
    .btn-cancel:hover { background: #e0e0e0; }

    /* Logo preview */
    .logo-preview {
      width: 52px;
      height: 52px;
      object-fit: contain;
      border-radius: 8px;
      margin-bottom: 8px;
      display: none;
    }

    /* FAVICON fallback container */
    .favicon-wrap {
      width: 52px;
      height: 52px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 10px;
      background: #f0f5f6;
      overflow: hidden;
    }

    .favicon-wrap img {
      width: 52px;
      height: 52px;
    }

    @media (max-width: 600px) {
      header { flex-wrap: wrap; gap: 12px; }
      .search-bar { max-width: 100%; margin: 0; order: 3; flex: 1 1 100%; }
      main { padding: 16px; }
    }
  </style>
</head>
<body>

<!-- HEADER -->
<header>
  <div class="header-left">
    <img 
      src="https://framerusercontent.com/images/ZKpBVJrKUhgEfVWEDuBsHFqxoM.png" 
      alt="Moxie Logo" 
      class="moxie-logo"
      onerror="this.style.display='none'"
    />
    <h1>Moxie Dashboard</h1>
  </div>
  <div class="search-bar">
    <input type="text" id="searchInput" placeholder="ðŸ” Search apps..." oninput="filterApps()"/>
  </div>
  <button class="add-btn" onclick="openModal()">+ Add App</button>
</header>

<!-- MAIN -->
<main id="mainContent">
  <!-- Categories rendered by JS -->
</main>

<!-- ADD APP MODAL -->
<div class="modal-overlay" id="modalOverlay">
  <div class="modal">
    <h2>âž• Add New App</h2>

    <label>App Name *</label>
    <input type="text" id="newAppName" placeholder="e.g. Notion" />

    <label>URL *</label>
    <input type="text" id="newAppUrl" placeholder="https://..." />

    <label>Category</label>
    <select id="newAppCategory">
      <option value="Communication">ðŸ“¬ Communication</option>
      <option value="Project Management">ðŸ“‹ Project Management</option>
      <option value="Finance">ðŸ’° Finance</option>
      <option value="Sales & CRM">ðŸ›’ Sales & CRM</option>
      <option value="Operations">ðŸ”§ Operations</option>
      <option value="AI Tools">ðŸ¤– AI Tools</option>
    </select>

    <label>Logo URL (optional â€” leave blank to use favicon)</label>
    <input type="text" id="newAppLogo" placeholder="https://..." oninput="previewLogo()" />
    <img id="logoPreview" class="logo-preview" src="" alt="Preview"/>

    <label>Or paste/upload logo image</label>
    <input type="file" id="newAppLogoFile" accept="image/*" onchange="handleLogoUpload()" />

    <div class="modal-actions">
      <button class="btn-cancel" onclick="closeModal()">Cancel</button>
      <button class="btn-save" onclick="saveApp()">Save App</button>
    </div>
  </div>
</div>

<script>
// â”€â”€â”€ DEFAULT APPS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const DEFAULT_APPS = [
  // Communication
  { name: "Gmail",          url: "https://mail.google.com",       category: "Communication",     logo: "" },
  { name: "Google Meet",    url: "https://meet.google.com",       category: "Communication",     logo: "" },
  { name: "Slack",          url: "https://slack.com",             category: "Communication",     logo: "" },
  { name: "Loom",           url: "https://www.loom.com",          category: "Communication",     logo: "" },
  { name: "Fathom",         url: "https://fathom.video/home",     category: "Communication",     logo: "" },

  // Project Management
  { name: "Asana",          url: "https://app.asana.com/1/1203386861136560/home",  category: "Project Management", logo: "" },
  { name: "Notion",         url: "https://www.notion.so/moxie-docs/6060ef49fea04dc3a1dc0a32d0564233", category: "Project Management", logo: "" },
  { name: "Arrows",         url: "https://success.joinmoxie.com/home", category: "Project Management", logo: "" },

  // Finance
  { name: "Ramp",           url: "https://app.ramp.com/sign-in",  category: "Finance",           logo: "" },
  { name: "Stripe",         url: "https://dashboard.stripe.com/register?account_invite=uis_sSEYJeeK7OA10mzCAF69eIyxWICgGRPI", category: "Finance", logo: "" },
  { name: "JustWorks",      url: "https://payroll.justworks.com/account/vouchers", category: "Finance", logo: "" },

  // Sales & CRM
  { name: "HubSpot",        url: "https://app.hubspot.com/login/?loginRedirectUrl=https%3A%2F%2Fapp.hubspot.com%2Fcontacts%2F22420370%2Fobjects%2F0-1%2Fviews%2Fall%2Flist&loginPortalId=22420370", category: "Sales & CRM", logo: "" },
  { name: "Shopify",        url: "https://admin.shopify.com/store/moxie-9681", category: "Sales & CRM", logo: "" },

  // Operations
  { name: "Omni",           url: "https://moxie.omniapp.co",      category: "Operations",        logo: "" },
  { name: "Glean",          url: "https://app.glean.com/?qe=https%3A%2F%2Fjoinmoxie-be.glean.com&utm_source=admin_invite&utm_medium=email&utm_campaign=vanity_v3&skip_to_sso=1&setup=welcome", category: "Operations", logo: "" },
  { name: "Zapier",         url: "https://zapier.com",            category: "Operations",        logo: "" },
  { name: "1Password",      url: "https://my.1password.com",      category: "Operations",        logo: "" },
  { name: "Dropbox Sign",   url: "https://app.hellosign.com/account/logIn", category: "Operations", logo: "" },
  { name: "Google Sheets",  url: "https://sheets.google.com",     category: "Operations",        logo: "" },
  { name: "Google Calendar",url: "https://calendar.google.com",   category: "Operations",        logo: "" },
  { name: "Moxie Admin",    url: "https://api.prod.internal.joinmoxie.com/admin/login/", category: "Operations", logo: "" },
  { name: "GitHub",         url: "https://github.com",            category: "Operations",        logo: "" },

  // AI Tools
  { name: "ChatGPT",        url: "https://chatgpt.com",           category: "AI Tools",          logo: "" },
];

// â”€â”€â”€ CATEGORY CONFIG â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const CATEGORY_META = {
  "Communication":     { emoji: "ðŸ“¬", label: "Communication" },
  "Project Management":{ emoji: "ðŸ“‹", label: "Project Management" },
  "Finance":           { emoji: "ðŸ’°", label: "Finance" },
  "Sales & CRM":       { emoji: "ðŸ›’", label: "Sales & CRM" },
  "Operations":        { emoji: "ðŸ”§", label: "Operations" },
  "AI Tools":          { emoji: "ðŸ¤–", label: "AI Tools" },
};

// â”€â”€â”€ STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let apps = [];
let uploadedLogoData = null;

function loadApps() {
  const stored = localStorage.getItem("moxieApps");
  if (stored) {
    apps = JSON.parse(stored);
  } else {
    apps = [...DEFAULT_APPS];
    saveApps();
  }
}

function saveApps() {
  localStorage.setItem("moxieApps", JSON.stringify(apps));
}

// â”€â”€â”€ FAVICON HELPER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function getFaviconUrl(siteUrl) {
  try {
    const domain = new URL(siteUrl).origin;
    return `https://www.google.com/s2/favicons?domain=${domain}&sz=64`;
  } catch(e) {
    return "";
  }
}

// â”€â”€â”€ RENDER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function render(filter = "") {
  const main = document.getElementById("mainContent");
  main.innerHTML = "";

  const categoryOrder = Object.keys(CATEGORY_META);

  categoryOrder.forEach(cat => {
    const filtered = apps.filter(a =>
      a.category === cat &&
      (filter === "" || a.name.toLowerCase().includes(filter.toLowerCase()))
    );

    if (filtered.length === 0) return;

    const meta = CATEGORY_META[cat];
    const section = document.createElement("section");
    section.className = "category";

    const header = document.createElement("div");
    header.className = "category-header";
    header.innerHTML = `<span class="emoji">${meta.emoji}</span><h2>${meta.label}</h2>`;
    section.appendChild(header);

    const grid = document.createElement("div");
    grid.className = "app-grid";

    filtered.forEach(app => {
      const appIndex = apps.indexOf(app);
      const imgSrc = app.logo || getFaviconUrl(app.url);

      const card = document.createElement("a");
      card.className = "app-card";
      card.href = app.url;
      card.target = "_blank";
      card.rel = "noopener noreferrer";

      card.innerHTML = `
        <button class="delete-btn" title="Remove" onclick="removeApp(event, ${appIndex})">âœ•</button>
        <div class="favicon-wrap">
          <img src="${imgSrc}" alt="${app.name}" 
               onerror="this.src='https://www.google.com/s2/favicons?domain=google.com&sz=64'" />
        </div>
        <span class="app-name">${app.name}</span>
      `;

      grid.appendChild(card);
    });

    section.appendChild(grid);
    main.appendChild(section);
  });

  // Handle any custom categories not in default list
  const customCats = [...new Set(apps.map(a => a.category))].filter(c => !categoryOrder.includes(c));
  customCats.forEach(cat => {
    const filtered = apps.filter(a =>
      a.category === cat &&
      (filter === "" || a.name.toLowerCase().includes(filter.toLowerCase()))
    );
    if (filtered.length === 0) return;

    const section = document.createElement("section");
    section.className = "category";
    const header = document.createElement("div");
    header.className = "category-header";
    header.innerHTML = `<span class="emoji">ðŸ“Œ</span><h2>${cat}</h2>`;
    section.appendChild(header);

    const grid = document.createElement("div");
    grid.className = "app-grid";

    filtered.forEach(app => {
      const appIndex = apps.indexOf(app);
      const imgSrc = app.logo || getFaviconUrl(app.url);
      const card = document.createElement("a");
      card.className = "app-card";
      card.href = app.url;
      card.target = "_blank";
      card.rel = "noopener noreferrer";
      card.innerHTML = `
        <button class="delete-btn" title="Remove" onclick="removeApp(event, ${appIndex})">âœ•</button>
        <div class="favicon-wrap">
          <img src="${imgSrc}" alt="${app.name}"
               onerror="this.src='https://www.google.com/s2/favicons?domain=google.com&sz=64'" />
        </div>
        <span class="app-name">${app.name}</span>
      `;
      grid.appendChild(card);
    });

    section.appendChild(grid);
    main.appendChild(section);
  });
}

// â”€â”€â”€ SEARCH â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function filterApps() {
  const q = document.getElementById("searchInput").value;
  render(q);
}

// â”€â”€â”€ REMOVE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function removeApp(e, index) {
  e.preventDefault();
  e.stopPropagation();
  if (confirm(`Remove "${apps[index].name}" from your dashboard?`)) {
    apps.splice(index, 1);
    saveApps();
    render();
  }
}

// â”€â”€â”€ MODAL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function openModal() {
  document.getElementById("modalOverlay").classList.add("active");
  document.getElementById("newAppName").value = "";
  document.getElementById("newAppUrl").value = "";
  document.getElementById("newAppLogo").value = "";
  document.getElementById("newAppLogoFile").value = "";
  document.getElementById("logoPreview").style.display = "none";
  uploadedLogoData = null;
}

function closeModal() {
  document.getElementById("modalOverlay").classList.remove("active");
}

function previewLogo() {
  const url = document.getElementById("newAppLogo").value;
  const img = document.getElementById("logoPreview");
  if (url) {
    img.src = url;
    img.style.display = "block";
  } else {
    img.style.display = "none";
  }
}

function handleLogoUpload() {
  const file = document.getElementById("newAppLogoFile").files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = function(e) {
    uploadedLogoData = e.target.result;
    const img = document.getElementById("logoPreview");
    img.src = uploadedLogoData;
    img.style.display = "block";
  };
  reader.readAsDataURL(file);
}

function saveApp() {
  const name     = document.getElementById("newAppName").value.trim();
  const url      = document.getElementById("newAppUrl").value.trim();
  const category = document.getElementById("newAppCategory").value;
  const logoUrl  = document.getElementById("newAppLogo").value.trim();

  if (!name || !url) {
    alert("App name and URL are required.");
    return;
  }

  const logo = uploadedLogoData || logoUrl || "";

  apps.push({ name, url, category, logo });
  saveApps();
  closeModal();
  render();
}

// Close modal on overlay click
document.getElementById("modalOverlay").addEventListener("click", function(e) {
  if (e.target === this) closeModal();
});

// â”€â”€â”€ INIT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
loadApps();
render();
</script>
</body>
</html>

